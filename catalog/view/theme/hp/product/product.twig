{{ header }}
  {# <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link href="{{ 'https://fonts.googleapis.com/css2?family=Poppins+One&family=Poppins:wght@400;500;600;700&display=swap' }}" rel="stylesheet">
  <link href="catalog\view\theme\hp\stylesheet\enhanced-hp\home\category.css" rel="stylesheet" />
  <link href="catalog\view\theme\hp\stylesheet\enhanced-hp\home\product.css" rel="stylesheet" /> #}
<div class="custom-header-bar py-3">
  <div class="container">
    <div class="row align-items-center justify-content-end">
      <div class="col-12 col-md-6 col-lg-4 search-bar">
        <div class="search-cart d-flex justify-content-end align-items-center">
          <div class="search flex-grow me-2">{{ search }}</div>
          <div class="carts">{{ cart }}</div>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="product-product" class="container mb-5">
  <nav class="mb-4 mt-4" aria-label="breadcrumb">
    <ol class="breadcrumb">
      {% for breadcrumb in breadcrumbs %}
        <li class="breadcrumb-item">
          <a class="text-decoration-none text-dark" href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a>
        </li>
      {% endfor %}
    </ol>
  </nav>

  <div class="row p-3 rounded-3 mainproduct">
    {% set left = column_left ? 1 : 0 %}
    {% set right = column_right ? 1 : 0 %}
    {% set mainCol = 12 - (left + right) * 3 %}

    {% if column_left %}
      <aside class="col-md-3">{{ column_left }}</aside>
    {% endif %}

    <main id="content" class="col-md-{{ mainCol }}">
      {{ content_top }}

      <div class="row">
        <div class="col-md-6 card">
          {% if thumb or images %}
            <ul class="list-unstyled d-flex flex-wrap gap-2 justify-content">
              {% if thumb %}
                <li>
                  <a href="{{ popup }}" title="{{ heading_title }}">
                    <img src="{{ thumb }}" alt="{{ heading_title }}" class="img-fluid card-img-top" style="height: 270px;"/>
                  </a>
                </li>
              {% endif %}
              {% for image in images %}
                <li>
                  <a href="{{ image.popup }}" title="{{ heading_title }}">
                    <img src="{{ image.thumb }}" alt="{{ heading_title }}" class="img-thumbnail"/>
                  </a>
                </li>
              {% endfor %}
            </ul>
          {% endif %}

          <div>
            <div class="card-body">
              <p class="card-header">{{ tab_description }}</p>
              <p class="card-text">{{ description }}</p>
            </div>
          </div>
          {# <ul class="nav nav-tabs mt-3" role="tablist">
            <li class="nav-item">
              <a class="nav-link active" data-toggle="tab" href="#tab-description">{{ tab_description }}</a>
            </li>
            {% if attribute_groups %}
              <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#tab-specification">{{ tab_attribute }}</a>
              </li>
            {% endif %}
            {% if review_status %}
              <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#tab-review">{{ tab_review }}</a>
              </li>
            {% endif %}
          </ul> #}

          {# <div class="tab-content mt-3">
            <div class="tab-pane fade show active" id="tab-description">{{ description }}</div>
            {% if attribute_groups %}
              <div class="tab-pane fade" id="tab-specification">
                <table class="table table-bordered">
                  {% for attribute_group in attribute_groups %}
                    <thead>
                      <tr><th colspan="2">{{ attribute_group.name }}</th></tr>
                    </thead>
                    <tbody>
                      {% for attribute in attribute_group.attribute %}
                        <tr>
                          <td>{{ attribute.name }}</td>
                          <td>{{ attribute.text }}</td>
                        </tr>
                      {% endfor %}
                    </tbody>
                  {% endfor %}
                </table>
              </div>
            {% endif %}
            {% if review_status %}
              <div class="tab-pane fade" id="tab-review">
                <form class="mt-3" id="form-review" method="post" enctype="multipart/form-data">
                  <div id="review"></div>
                  <h5>{{ text_write }}</h5>
                  {% if review_guest %}
                    <div class="mb-3">
                      <label>Display Name:</label>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="is_anonymous" value="0" checked>
                        <label class="form-check-label">Show my name</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="is_anonymous" value="1">
                        <label class="form-check-label">Post as Anonymous</label>
                      </div>
                    </div>
                    <div class="mb-3">
                      <label for="input-attachment">Attach a file</label>
                      <input type="file" name="attachment" class="form-control" />
                    </div>
                    <div class="mb-3">
                      <label for="input-review">{{ entry_review }}</label>
                      <textarea name="text" rows="5" id="input-review" class="form-control"></textarea>
                    </div>
                    <div class="mb-3">
                      <label class="control-label">{{ entry_rating }}</label>
                      <div>
                        {% for i in 1..5 %}
                          <label class="me-2"><input type="radio" name="rating" value="{{ i }}"> {{ i }}</label>
                        {% endfor %}
                      </div>
                    </div>
                    {{ captcha }}
                    <button type="button" id="button-review" class="btn btn-primary">{{ button_continue }}</button>
                  {% else %}
                    {{ text_login }}
                  {% endif %}
                </form>
              </div>
            {% endif %}
          </div> #}
        </div>

        <div class="col-md-6 px-4">
          <div class="d-flex mb-3">
            <button type="button" class="btn btn-outline-secondary me-2" title="{{ button_wishlist }}" onclick="wishlist.add('{{ product_id }}');">
              <i class="fa fa-heart"></i>
            </button>
            <button type="button" class="btn btn-outline-secondary" title="{{ button_compare }}" onclick="compare.add('{{ product_id }}');">
              <i class="fa fa-exchange"></i>
            </button>
          </div>

          <h1>{{ heading_title }}</h1>
          <ul class="list-unstyled">
            {% if manufacturer %}
              <li>{{ text_manufacturer }}: <a href="{{ manufacturers }}">{{ manufacturer }}</a></li>
            {% endif %}
            <li>{{ text_model }}: {{ model }}</li>
            <li>Weight: {{ weight }} grams</li>
            <li>{{ text_stock }}: {{ stock }}</li>
          </ul>

          {% if price %}
            <ul class="list-unstyled">
              {% if not special %}
                <li><h2>{{ price }}</h2></li>
              {% else %}
                <li><span class="text-muted text-decoration-line-through">{{ price }}</span></li>
                <li><h2 class="text-danger">{{ special }}</h2></li>
              {% endif %}
              {% if tax %}<li>{{ text_tax }} {{ tax }}</li>{% endif %}
              {% if points %}<li>{{ text_points }} {{ points }}</li>{% endif %}
            </ul>
          {% endif %}

          <form>
            {% if options %}
              <hr>
              <h4>{{ text_option }}</h4>
              {% for option in options %}
                <div class="mb-3">
                  <label class="form-label">{{ option.name }}</label>
                  <div>
                    {% for option_value in option.product_option_value %}
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="option[{{ option.product_option_id }}]" value="{{ option_value.product_option_value_id }}">
                        <label class="form-check-label">
                          {{ option_value.name }}
                          {% if option_value.price %} ({{ option_value.price_prefix }}{{ option_value.price }}){% endif %}
                        </label>
                      </div>
                    {% endfor %}
                  </div>
                </div>
              {% endfor %}
            {% endif %}

            <div class="mb-3">
              <label for="input-quantity">{{ entry_qty }}</label>
              <input type="number" id="input-quantity" name="quantity" value="{{ minimum }}" class="form-control" />
            </div>

            <input type="hidden" name="product_id" value="{{ product_id }}">
            <button type="button" id="button-cart" class="btn btn-primary btn-lg btn-block">{{ button_cart }}</button>

            {% if minimum > 1 %}
              <div class="alert alert-info mt-2">{{ text_minimum }}</div>
            {% endif %}
          </form>

          {% if review_status %}
            <div class="mt-3">
              <p>
                {% for i in 1..5 %}
                  {% if rating < i %}
                    <span class="fa fa-star-o text-warning"></span>
                  {% else %}
                    <span class="fa fa-star text-warning"></span>
                  {% endif %}
                {% endfor %}
                <a href="#tab-review" onclick="$('a[href=\'#tab-review\']').tab('show'); return false;">{{ reviews }}</a>
                / 
                <a href="#tab-review" onclick="$('a[href=\'#tab-review\']').tab('show'); return false;">{{ text_write }}</a>
              </p>
            </div>
          {% endif %}
        </div>
      </div>

      {% if products %}
        <h3>{{ text_related }}</h3>
        <div class="row">
          {% for product in products %}
            <div class="col-md-3 col-sm-6 mb-4">
              <div class="card h-100">
                <a href="{{ product.href }}">
                  <img src="{{ product.thumb }}" class="card-img-top" alt="{{ product.name }}">
                </a>
                <div class="card-body">
                  <h5 class="card-title">
                    <a href="{{ product.href }}">{{ product.name }}</a>
                  </h5>
                  <p class="card-text">{{ product.description }}</p>
                  {% if product.rating %}
                    <div class="rating mb-2">
                      {% for j in 1..5 %}
                        {% if product.rating < j %}
                          <span class="fa fa-star-o text-warning"></span>
                        {% else %}
                          <span class="fa fa-star text-warning"></span>
                        {% endif %}
                      {% endfor %}
                    </div>
                  {% endif %}
                  {% if product.price %}
                    <p class="price">
                      {% if not product.special %}
                        {{ product.price }}
                      {% else %}
                        <span class="text-danger">{{ product.special }}</span>
                        <span class="text-muted text-decoration-line-through">{{ product.price }}</span>
                      {% endif %}
                    </p>
                  {% endif %}
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      {% endif %}

      {% if tags %}
        <p>{{ text_tags }}
          {% for i in 0..tags|length - 1 %}
            <a href="{{ tags[i].href }}">{{ tags[i].tag }}</a>{% if i < tags|length - 1 %}, {% endif %}
          {% endfor %}
        </p>
      {% endif %}

      {{ content_bottom }}
    </main>

    {% if column_right %}
      <aside class="col-md-3">{{ column_right }}</aside>
    {% endif %}
  </div>
</div>


<script
	type="text/javascript">
	<!--
	$('select[name=\'recurring_id\'], input[name="quantity"]').change(function () {
$.ajax({
url: 'index.php?route=product/product/getRecurringDescription',
type: 'post',
data: $('input[name=\'product_id\'], input[name=\'quantity\'], select[name=\'recurring_id\']'),
dataType: 'json',
beforeSend: function () {
$('#recurring-description').html('');
},
success: function (json) {
$('.alert-dismissible, .text-danger').remove();

if (json['success']) {
$('#recurring-description').html(json['success']);
}
}
});
});
//
	-->
</script>
<script type="text/javascript">
  $(document).ready(function () {
    $('#button-cart').on('click', function () {
      $.ajax({
        url: 'index.php?route=checkout/cart/add',
        type: 'post',
        data: $('#product').find('input[type="text"], input[type="hidden"], input[type="radio"]:checked, input[type="checkbox"]:checked, select, textarea'),
        dataType: 'json',
        beforeSend: function () {
          $('#button-cart').prop('disabled', true).html('<span class="spinner-border spinner-border-sm"></span> Adding...');
        },
        complete: function () {
          $('#button-cart').prop('disabled', false).html('<i class="bi bi-cart"></i> Add to Cart');
        },
        success: function (json) {
          $('.alert-dismissible, .text-danger').remove();
          $('.form-group').removeClass('has-error');

          // Show errors
          if (json['error']) {
            if (json['error']['option']) {
              for (let i in json['error']['option']) {
                let element = $('#input-option' + i.replace('_', '-'));
                let errorHtml = '<div class="text-danger small">' + json['error']['option'][i] + '</div>';
                if (element.parent().hasClass('input-group')) {
                  element.parent().after(errorHtml);
                } else {
                  element.after(errorHtml);
                }
                element.closest('.form-group').addClass('has-error');
              }
            }

            if (json['error']['recurring']) {
              $('select[name="recurring_id"]').after('<div class="text-danger">' + json['error']['recurring'] + '</div>');
            }

            return;
          }
          console.log(json);

          if (json['success']) {
            $('.breadcrumb').after(`
              <div class="alert alert-success alert-dismissible fade show" role="alert">
                <i class="bi bi-check-circle-fill"></i> ${json['success']}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
              </div>
            `);

            // Update cart icon (top cart button)
            $('#cart > button').html(`
              <span id="cart-total"><i class="bi bi-cart"></i> ${json['total']}</span>
            `);

            // Reload cart dropdown contents
            $('#cart').load('index.php?route=common/cart/info #cart > *');

            // Scroll to top
            $('html, body').animate({ scrollTop: 0 }, 'smooth');
            location.reload();

          }
            },
        error: function (xhr, ajaxOptions, thrownError) {
          alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        }
      });
    });
  });
</script>

<script
	type="text/javascript">
	<!--
	$('.date').datetimepicker({language: '{{ datepicker }}', pickTime: false});

$('.datetime').datetimepicker({language: '{{ datepicker }}', pickDate: true, pickTime: true});

$('.time').datetimepicker({language: '{{ datepicker }}', pickDate: false});

$('button[id^=\'button-upload\']').on('click', function () {
var node = this;

$('#form-upload').remove();

$('body').prepend('<form enctype="multipart/form-data" id="form-upload" style="display: none;"><input type="file" name="file" /></form>');

$('#form-upload input[name=\'file\']').trigger('click');

if (typeof timer != 'undefined') {
clearInterval(timer);
}

timer = setInterval(function () {
if ($('#form-upload input[name=\'file\']').val() != '') {
clearInterval(timer);

$.ajax({
url: 'index.php?route=tool/upload',
type: 'post',
dataType: 'json',
data: new FormData($('#form-upload')[0]),
cache: false,
contentType: false,
processData: false,
beforeSend: function () {
$(node).button('loading');
},
complete: function () {
$(node).button('reset');
},
success: function (json) {
$('.text-danger').remove();

if (json['error']) {
$(node).parent().find('input').after('<div class="text-danger">' + json['error'] + '</div>');
}

if (json['success']) {
alert(json['success']);

$(node).parent().find('input').val(json['code']);
}
},
error: function (xhr, ajaxOptions, thrownError) {
alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
}
});
}
}, 500);
});
//
	-->
</script>
<script
	type="text/javascript">
	<!--
	$('#review').delegate('.pagination a', 'click', function (e) {
e.preventDefault();

$('#review').fadeOut('slow');

$('#review').load(this.href);

$('#review').fadeIn('slow');
});

$('#review').load('index.php?route=product/product/review&product_id=   {{ product_id }}');

$('#button-review').on('click', function (e) {
e.preventDefault();

var form = document.getElementById('form-review');
var formData = new FormData(form);

$.ajax({
url: 'index.php?route=product/product/write&product_id=   {{ product_id }}',
type: 'post',
dataType: 'json',
data: formData,
contentType: false,
processData: false,
beforeSend: function () {
$('#button-review').button('loading');
},
complete: function () {
$('#button-review').button('reset');
},
success: function (json) {
$('.alert-dismissible').remove();

if (json['error']) {
$('#review').after('<div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> ' + json['error'] + '</div>');
}

if (json['success']) {
$('#review').after('<div class="alert alert-success alert-dismissible"><i class="fa fa-check-circle"></i> ' + json['success'] + '</div>');

$('#form-review')[0].reset(); // Clear all form fields including file input
}
}
});
});


$(document).ready(function () {
$('.thumbnails').magnificPopup({
type: 'image',
delegate: 'a',
gallery: {
enabled: true
}
});
});
//
	-->
</script>
{{ footer }}
